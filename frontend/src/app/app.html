<div class="container">
  <header class="glass-header">
    <h1>{{ title() }}</h1>
    <span class="status-badge" [class.offline]="!connected()">
        {{ connected() ? 'Live' : 'Disconnected' }}
    </span>
  </header>

  <main>
    <div *ngIf="!connected()" class="error-banner">
        ⚠️ Cannot connect to Trading Bot Backend. Make sure the Java app is running.
    </div>

    <div class="config-panel" *ngIf="connected()">
        <div class="current-config">
            <span class="label">Running Strategy</span>
            <span class="value">{{ currentStrategy() }}</span>
        </div>
        
        <div class="config-form">
            <div class="form-group">
                <select [(ngModel)]="selectedStrategy">
                    <option *ngFor="let s of strategies" [value]="s">{{ s }}</option>
                </select>
            </div>
            <div class="form-group">
                <select [(ngModel)]="selectedDecorator">
                    <option *ngFor="let d of decorators" [value]="d">{{ d }}</option>
                </select>
            </div>
            <button (click)="applyConfig()">Update</button>
        </div>
    </div>

    <div class="stats-overview">
        <div class="stat-item">
            <span class="label">Est. Value (USDT)</span>
            <span class="value">{{ portfolioValue() | number:'1.2-2' }}</span>
        </div>
        <div class="stat-item">
            <span class="label">Liquid USDT</span>
            <span class="value">{{ usdtBalance() | number:'1.2-2' }}</span>
        </div>
        <div class="stat-item">
            <span class="label">BTC Holdings</span>
            <span class="value">{{ btcBalance() | number:'1.4-4' }}</span>
        </div>
        <div class="stat-item">
            <span class="label">PnL %</span>
            <span class="value" [class.profit]="portfolioValue() >= 1000" [class.loss]="portfolioValue() < 1000">
                {{ ((portfolioValue() - 1000) / 1000) | percent:'1.2-2' }}
            </span>
        </div>
    </div>

    <div class="trade-feed">
      <h3>Recent Activity</h3>
      
      <div class="trade-list">
        <div class="trade-card" *ngFor="let trade of trades" [class.buy]="trade.side === 'BUY'" [class.sell]="trade.side === 'SELL'">
          <div class="card-left">
            <div class="symbol">{{ trade.symbol }}</div>
            <div class="timestamp">{{ trade.timestamp | date:'HH:mm:ss' }}</div>
          </div>
          <div class="card-right">
            <div class="side-badge">{{ trade.side }}</div>
            <div class="quantity">{{ trade.quantity }} BTC</div>
          </div>
        </div>
      </div>
      
      <div *ngIf="trades.length === 0" class="empty-state">
        Waiting for market signals...
      </div>
    </div>
  </main>
</div>
